import React, { useCallback, useState, useEffect, useRef } from 'react'
import styled from 'styled-components'

import { API_ORIGIN } from './constant'
import { samlpePeaks, samplePeaksData } from './utils'

const peaks = [
  -5564, 5702, -5651, 5642, -5672, 5915, -5689, 5840, -5698, 5830, -5756, 5755,
  -5912, 5957, -5868, 5925, -5812, 5953, -5798, 5811, -5832, 5894, -2211, 2346,
  -5447, 5870, -5644, 5677, -5705, 5834, -5734, 5827, -5821, 5974, -5913, 5884,
  -381, 408, -345, 337, -123, 125, -10, 10, -5652, 5969, -5655, 5850, -5673,
  5738, -5702, 5870, -5756, 5828, -5864, 5957, -5853, 5803, -5865, 5917, -5792,
  5953, -5776, 5894, -5836, 5722, -350, 344, -5646, 5865, -5650, 5832, -5703,
  5686, -5758, 5820, -5903, 5969, -5801, 5770, -425, 419, -234, 237, -31, 31,
  -5486, 5983, -5652, 5690, -5689, 5892, -5712, 5874, -5706, 5859, -5749, 5750,
  -5802, 5860, -5784, 5825, -5797, 6012, -5810, 5846, -5771, 6013, -3689, 3309,
  -5351, 5892, -5643, 5789, -5679, 5885, -5740, 5855, -5716, 5756, -5804, 5862,
  -516, 529, -292, 295, -111, 111, -6, 7, -5653, 5990, -5649, 5888, -5691, 5667,
  -5715, 5872, -5747, 5856, -5750, 5848, -5802, 5801, -5801, 5825, -5811, 6019,
  -5777, 6007, -5769, 5758, -237, 248, -5643, 5893, -5638, 5884, -5679, 5689,
  -5746, 5855, -5802, 5859, -5766, 5741, -298, 290, -224, 228, -25, 26, -5397,
  5958, -5841, 5779, -6301, 6378, -6315, 6630, -6467, 6726, -7175, 6929, -7780,
  7309, -7702, 7729, -7796, 7932, -7810, 8146, -7814, 8389, -4900, 7166, -2832,
  3216, -7977, 9237, -8067, 9736, -8559, 9754, -8506, 9670, -9212, 9212, -3849,
  3351, -4248, 3388, -4202, 3027, -3922, 2888, -7469, 7987, -7795, 8182, -7732,
  7733, -8452, 8168, -8131, 8066, -8308, 8054, -8229, 7550, -7974, 8246, -8094,
  7912, -8165, 8130, -9046, 7641, -3531, 2997, -8690, 8724, -8079, 8871, -8790,
  8951, -8296, 9186, -8945, 8456, -8998, 8396, -3223, 2710, -3396, 2529, -2594,
  2231, -5531, 5738, -7186, 6908, -6895, 6941, -7073, 6956, -6905, 6864, -7713,
  7562, -7625, 7811, -7774, 8210, -8476, 8752, -8265, 8216, -7621, 8469, -5649,
  7736, -3120, 2874, -8343, 8250, -8445, 8458, -8138, 8763, -8993, 8820, -9588,
  9355, -4465, 3949, -3382, 3509, -3482, 3716, -3437, 3767, -8725, 8427, -7911,
  7727, -7692, 7838, -8177, 7901, -8615, 8314, -8397, 7901, -8294, 7315, -8672,
  7495, -8415, 7606, -7764, 7670, -8614, 7994, -3084, 2922, -8124, 8215, -8792,
  8890, -9200, 8832, -9142, 9499, -9223, 9469, -9232, 9459, -3233, 3628, -3160,
  2650, -2628, 2495, -1672, 1591, -7033, 6792, -6593, 6892, -6940, 7403, -7031,
  8037, -7837, 7801, -7942, 8290, -8235, 7973, -8154, 8225, -8254, 8070, -7975,
  8752, -7352, 5776, -2785, 3300, -8202, 8675, -7584, 8993, -8138, 9237, -8487,
  10078, -9047, 10208, -3995, 4982, -3676, 4594, -2961, 3485, -3123, 3590,
  -7101, 7916, -6937, 7414, -8279, 7463, -8141, 7485, -7973, 7825, -7350, 7656,
  -8426, 7696, -7772, 7813, -7403, 7627, -7499, 7242, -7676, 7290, -2545, 1886,
  -8048, 7501, -7912, 7597, -8507, 8012, -8632, 8380, -8540, 8925, -8560, 8887,
  -2925, 3318, -2669, 3195, -1873, 2375, -1502, 1471, -6593, 6475, -6955, 6948,
  -7144, 6546, -6641, 7279, -7310, 7776, -8639, 8258, -8680, 7413, -9035, 8768,
  -9017, 8674, -7765, 8233, -8276, 7559, -2710, 2719, -8057, 8250, -7866, 8782,
  -7563, 8385, -8437, 9036, -8455, 9505, -3977, 6794, -3959, 4599, -3731, 4335,
  -3711, 4417, -7620, 7064, -7950, 7875, -8739, 8109, -9126, 8104, -8708, 8435,
  -9109, 7841, -9042, 7773, -8564, 7933, -8385, 7577, -8626, 8118, -8368, 8414,
  -2772, 3008, -7204, 7470, -7691, 7041, -8381, 8013, -7832, 7972, -8621, 8123,
  -8412, 7980, -2671, 2687, -2709, 2142, -2262, 1977, -1880, 1886, -7100, 7123,
  -6788, 7222, -6990, 8007, -7588, 7623, -9969, 9446, -12309, 11426, -10776,
  11335, -10130, 11487, -11166, 11772, -11268, 10913, -10445, 10191, -9642,
  7569, -12304, 12260, -11405, 12060, -11817, 11798, -12762, 14112, -11859,
  12678, -9714, 8544, -5857, 5878, -5774, 7386, -6013, 7412, -9507, 9928,
  -10361, 9518, -10888, 11857, -12338, 12479, -10795, 11683, -10875, 11919,
  -12164, 10551, -9795, 9490, -10236, 10196, -10705, 10438, -11667, 10422,
  -6685, 6268, -10439, 9473, -10500, 12633, -11335, 12329, -10910, 11360,
  -10022, 11208, -11179, 11443, -6047, 5857, -5977, 5820, -6464, 6548, -5541,
  6001, -9622, 9839, -10093, 11107, -9963, 9896, -12538, 11790, -12555, 12936,
  -10969, 10773, -10097, 11096, -9978, 10860, -9748, 10213, -9976, 9425, -11144,
  10746, -6136, 7577, -10755, 12045, -10690, 12044, -11023, 11704, -10233,
  10383, -10859, 10816, -10130, 8350, -5556, 6299, -7263, 6737, -7335, 7857,
  -10283, 12727, -12043, 11135, -10575, 10896, -10665, 10945, -10234, 11221,
  -11359, 11425, -10369, 10620, -9068, 9573, -10384, 9897, -10794, 11353,
  -11795, 10628, -6212, 6717, -8102, 7954, -10357, 11373, -11609, 11506, -11344,
  11435, -10449, 9952, -10961, 12196, -5599, 6101, -5316, 5752, -5721, 6392,
  -5343, 5986, -9325, 10344, -7554, 8248, -7496, 7630, -8267, 9182, -7601, 7922,
  -8670, 8871, -8886, 8436, -8657, 8708, -8584, 8567, -8274, 7712, -7994, 8185,
  -3389, 3929, -8039, 8796, -8269, 9380, -8237, 9860, -8615, 9752, -9410, 8782,
  -8170, 7917, -4509, 3458, -4156, 2907, -3955, 2752, -6999, 6747, -7503, 8147,
  -8270, 7757, -8505, 7886, -8017, 7649, -8198, 8019, -8157, 7735, -7935, 8361,
  -8104, 7736, -8224, 7451, -8838, 8083, -4193, 5328, -7024, 8255, -8491, 8773,
  -8708, 9010, -8283, 9151, -8058, 8893, -9209, 8552, -3404, 3073, -3286, 2553,
  -3231, 2404, -2436, 1935, -7233, 6934, -6751, 6895, -7077, 6927, -7560, 7216,
  -7538, 7690, -7918, 7144, -7569, 7868, -8490, 8835, -8188, 8172, -7177, 7967,
  -7647, 8526, -3146, 2973, -8309, 8290, -7803, 8575, -8483, 8094, -9017, 8920,
  -9137, 9248, -9545, 8408, -3943, 3677, -3367, 3445, -3626, 3784, -8120, 7742,
  -8757, 8143, -7681, 7754, -8145, 7843, -8270, 7867, -8653, 8143, -8411, 7680,
  -8222, 7146, -8480, 7359, -8518, 7810, -8506, 7986, -6146, 5176, -3199, 2681,
  -8618, 8161, -9126, 8899, -8996, 9478, -8999, 9541, -9339, 9399, -3719, 3939,
  -3197, 3057, -2788, 2438, -1890, 2051, -8684, 8575, -9900, 10745, -10396,
  10429, -11586, 10746, -10924, 11311, -11397, 11014, -10597, 11673, -10545,
  10894, -9426, 9907, -10722, 10629, -10564, 10159, -6430, 6851, -8626, 9081,
  -7932, 7964, -8111, 9157, -9090, 10951, -8936, 10579, -8574, 9239, -3987,
  4641, -3355, 4092, -3156, 3692, -4235, 7179, -9543, 9960, -9756, 10927, -9820,
  10024, -9178, 9274, -11397, 10967, -12907, 11854, -11483, 11935, -10314,
  10400, -11196, 10803, -11366, 11112, -8797, 8060, -6975, 6644, -11058, 12429,
  -12358, 12904, -10861, 12736, -10585, 10706, -10080, 10671, -6909, 7863,
  -5789, 6849, -5792, 5418, -6831, 5944, -10557, 10311, -8672, 10804, -10622,
  8707, -9455, 9251, -10574, 10527, -11494, 11532, -12687, 11956, -12923, 11677,
  -11321, 11315, -11289, 10247, -12290, 11310, -7921, 7944, -10543, 8851, -9121,
  9162, -9619, 9296, -9018, 9286, -8883, 9186, -8416, 10080, -3861, 4471, -3690,
  3895, -3632, 3852, -4105, 3488, -8947, 8664, -10384, 11181, -10401, 10715,
  -11072, 10574, -12496, 11986, -12506, 11678, -10659, 10524, -11477, 10143,
  -10946, 11270, -10266, 10737, -9825, 9078, -8055, 7696, -11337, 10773, -12773,
  13009, -12298, 12605, -11677, 12009, -12044, 11591, -6213, 7243, -4675, 5364,
  -4594, 5791, -4982, 6242, -10630, 10882, -10716, 9679, -10302, 10588, -11041,
  10437, -12459, 12576, -11736, 11760, -11595, 12514, -11235, 12055, -10890,
  10347, -11291, 10611, -12001, 12543, -7651, 7679, -8895, 10190, -8252, 10167,
  -9006, 10683, -8860, 10874, -10262, 9635, -9942, 8923, -4248, 4275, -3790,
  4002, -4041, 3416, -4416, 3115, -7429, 8567, -8164, 8042, -8321, 7740, -8583,
  8130, -8086, 8209, -8287, 7935, -7921, 8150, -7873, 8425, -8005, 7928, -8443,
  8237, -7770, 7105, -3598, 3159, -8698, 8837, -8902, 9180, -8738, 9198, -8311,
  9258, -9085, 8558, -6458, 4304, -3337, 2606, -3359, 2617, -2508, 2112, -8603,
  8413, -9275, 10231, -10111, 10211, -10393, 10486, -10290, 10692, -9980, 10413,
  -9563, 10067, -9864, 10515, -9912, 11559, -10322, 11100, -10634, 12663, -6583,
  6909, -7951, 8854, -8704, 9630, -8571, 8932, -9448, 9714, -9215, 9761, -9592,
  9565, -4297, 4069, -3622, 3559, -3979, 4234, -3527, 3550, -11327, 10112,
  -10719, 9646, -9618, 10998, -10257, 9280, -12040, 11134, -12428, 12231,
  -10952, 12003, -11171, 10654, -11962, 11019, -9443, 11403, -8449, 11696,
  -6632, 5678, -11793, 12890, -10458, 13715, -12762, 13329, -12206, 14166,
  -12094, 13968, -8686, 9831, -5369, 6613, -5094, 4953, -5922, 6026, -11243,
  10187, -10017, 10624, -11123, 10152, -10189, 10489, -10590, 10078, -11976,
  10749, -12005, 14310, -11300, 13043, -12279, 12130, -11889, 11252, -11581,
  11842, -7179, 7043, -7531, 8756, -8917, 8608, -9210, 10882, -9716, 10727,
  -9609, 10897, -9063, 9912, -4211, 3730, -4313, 3874, -4472, 3394, -4548, 3543,
  -7987, 8401, -8068, 7841, -8657, 7523, -8716, 8224, -8179, 8033, -8399, 7642,
  -8395, 7506, -7848, 8413, -8079, 7897, -8118, 8017, -9309, 7732, -3710, 3035,
  -8699, 8772, -8851, 8906, -8597, 9038, -8356, 9187, -9192, 8440, -7041, 8289,
  -3245, 2721, -3373, 2533, -2582, 2172, -6509, 8402, -9335, 9107, -10050,
  10222, -10480, 10717, -9851, 10670, -10390, 10371, -9623, 10029, -9663, 10160,
  -10676, 9911, -10243, 11437, -10469, 12342, -6518, 7023, -6143, 8563, -8962,
  9419, -8441, 9044, -9321, 9425, -9151, 8887, -9761, 10063, -4258, 4073, -3663,
  3973, -3609, 4147, -3757, 3398, -10868, 9604, -10060, 9098, -9998, 10704,
  -9997, 9174, -11404, 10839, -11904, 11536, -10668, 11035, -10590, 10862,
  -10693, 10367, -10095, 10911, -8108, 11384, -6894, 5004, -11114, 11383, -9121,
  12216, -11486, 12846, -12294, 13213, -11564, 13240, -9843, 10301, -4858, 5847,
  -4126, 4421, -5108, 5241, -10034, 9081, -9975, 10393, -9710, 10118, -8974,
  9302, -10249, 8768, -10956, 10428, -11021, 10619, -10724, 11523, -10496,
  10764, -9095, 9784, -9521, 10277, -6288, 6608, -5092, 7580, -9457, 10617,
  -8574, 9600, -8122, 9866, -8549, 9278, -8932, 9856, -3849, 4914, -3985, 4718,
  -3122, 3765, -3332, 3891, -6866, 8682, -9993, 8682, -7777, 8453, -9147, 8750,
  -9792, 9271, -9062, 9226, -10747, 9983, -8874, 9457, -8983, 9015, -8165, 8212,
  -8855, 8739, -4310, 4999, -8090, 7121, -6968, 7321, -8533, 7821, -7719, 8034,
  -8215, 7958, -6832, 8750, -3224, 3800, -2784, 3526, -2009, 2308, -5684, 5601,
  -7458, 6783, -7418, 7497, -7355, 6443, -6485, 7264, -7491, 7956, -9514, 8704,
  -9404, 8867, -8509, 8301, -9087, 9030, -8632, 8803, -6460, 6346, -4544, 4311,
  -8452, 8063, -8082, 8131, -7513, 8212, -7929, 8819, -8247, 9409, -4046, 4613,
  -4019, 4379, -3709, 3991, -3980, 4072, -6961, 6414, -6322, 7768, -8410, 7404,
  -8358, 7574, -9079, 8219, -7086, 7238, -8632, 7331, -8019, 7430, -8166, 7291,
  -7628, 6731, -7642, 7090, -3825, 3322, -7271, 6490, -6991, 6927, -7646, 6905,
  -6998, 7009, -6977, 6456, -7224, 6133, -3028, 1969, -2975, 1869, -2579, 2178,
  -2202, 2452, -2174, 2386, -2066, 2456, -2168, 2056, -1770, 1868, -1687, 1417,
  -1497, 1282, -1290, 1208, -1204, 1132, -1195, 1149, -1103, 975, -964, 865,
  -997, 877, -826, 733, -656, 691, -513, 515, -435, 475, -327, 362, -267, 272,
  -182, 221, -124, 162, -100, 86, -18, 26, -8, 7, -5, 5, -8, 8, -6, 5, -4, 4,
  -3, 4, -3, 3, -2, 2, -2, 2, -1, 2, -5634, 5703, -5651, 5613, -5672, 5915,
  -5696, 5840, -5684, 5830, -5756, 5755, -5912, 5957, -5868, 5925, -5772, 5953,
  -5797, 5811, -5832, 5895, -1158, 1078, -5552, 5870, -5644, 5618, -5705, 5832,
  -5737, 5826, -5861, 5974, -5912, 5845, -350, 374, -345, 337, -105, 108, -8, 8,
  -5652, 5969, -5661, 5849, -5673, 5869, -5701, 5744, -5756, 5828, -5865, 5958,
  -5822, 5909, -5865, 5882, -5793, 5953, -5796, 5894, -5800, 5722, -305, 287,
  -5649, 5865, -5659, 5833, -5704, 5686, -5758, 5821, -5911, 5969, -5658, 5601,
  -425, 418, -207, 206, -27, 28, -5603, 5982, -5653, 5634, -5689, 5892, -5715,
  5874, -5685, 5860, -5749, 5743, -5802, 5860, -5791, 5826, -5801, 6010, -5810,
  5737, -5771, 6014, -1811, 1625, -5501, 5892, -5642, 5669, -5679, 5885, -5740,
  5855, -5704, 5844, -5803, 5809, -290, 296, -292, 295, -101, 100, -6, 6, -5652,
  5990, -5657, 5889, -5691, 5873, -5715, 5808, -5751, 5855, -5780, 5864, -5764,
  5758, -5802, 5826, -5811, 6018, -5618, 6008, -5769, 5722, -192, 192, -5643,
  5892, -5643, 5884, -5679, 5689, -5747, 5856, -5802, 5860, -5766, 5741, -298,
  290, -206, 208, -17, 17, -5557, 5957, -5841, 5776, -6301, 6378, -6523, 6631,
  -6791, 6726, -7175, 6930, -7779, 7309, -7701, 7729, -7796, 8210, -7809, 8063,
  -7813, 8389, -3617, 3885, -5114, 8653, -7978, 9237, -8068, 9736, -8558, 9676,
  -9118, 9670, -8822, 9213, -4248, 3351, -4051, 3389, -4087, 3026, -3918, 3034,
  -7469, 8182, -8269, 7480, -7598, 7575, -8453, 8169, -8132, 8066, -8309, 7658,
  -8229, 7414, -7972, 8246, -8094, 7911, -8118, 8130, -9047, 7641, -3501, 2998,
  -8691, 8724, -8276, 8872, -8788, 8950, -8296, 9185, -9179, 8514, -8757, 8361,
  -3222, 2709, -3396, 2528, -2593, 2230, -6031, 6500, -7186, 6908, -6895, 6940,
  -7074, 6956, -6906, 7102, -7714, 7562, -7625, 7810, -8352, 8465, -8477, 8254,
  -8265, 8215, -7622, 8469, -5487, 4262, -5803, 7628, -8343, 8250, -8446, 8458,
  -8802, 8763, -8993, 8820, -9587, 9355, -4465, 3625, -3244, 3508, -3482, 3767,
  -3437, 3437, -8725, 8428, -7782, 7125, -7635, 7837, -8177, 7901, -8616, 8314,
  -8187, 7400, -8213, 7314, -8672, 7494, -8415, 7605, -8070, 7567, -8168, 7994,
  -3084, 2923, -8302, 8216, -8926, 8891, -9199, 8832, -9143, 9498, -9297, 9468,
  -7984, 9459, -3233, 3628, -3160, 2649, -2628, 2495, -5456, 6085, -7032, 6791,
  -6625, 6892, -6940, 7412, -7031, 8038, -7837, 7801, -7942, 8289, -8235, 8070,
  -8154, 8226, -8253, 8070, -7975, 8752, -5810, 5548, -2785, 3188, -8202, 8674,
  -7583, 9237, -8228, 7663, -8458, 10077, -9047, 10208, -3580, 4858, -3594,
  4454, -3186, 3581, -3103, 3590, -7101, 7915, -8086, 7525, -8179, 7334, -8141,
  7486, -7974, 7826, -7746, 7657, -8424, 7695, -7773, 7812, -7558, 7627, -7208,
  7242, -7619, 7289, -2544, 1885, -8048, 7501, -7444, 7598, -8506, 8012, -8631,
  8379, -8674, 8925, -8561, 8887, -2925, 3319, -2575, 3042, -1873, 2375, -4434,
  1471, -6593, 6476, -6955, 6947, -7145, 6903, -6642, 6903, -7310, 7775, -8639,
  8256, -8680, 8300, -9036, 8480, -9018, 8675, -8380, 8233, -7331, 6272, -2568,
  3151, -8056, 8251, -7866, 8783, -8008, 8438, -8437, 9034, -8456, 9505, -3977,
  4887, -3938, 4599, -3933, 4272, -3711, 4417, -7790, 7771, -7868, 7592, -8740,
  8109, -9125, 8104, -8708, 8434, -9110, 7841, -9043, 7774, -8565, 7933, -8599,
  7577, -8255, 8118, -8368, 8414, -2772, 3008, -7852, 7470, -7519, 7042, -8382,
  8013, -8164, 7972, -8621, 8123, -8413, 7980, -2672, 2687, -2609, 2142, -2262,
  1978, -1807, 1887, -7101, 7126, -6802, 7348, -6991, 8005, -7588, 7622, -9970,
  9445, -12305, 11423, -10775, 11178, -10131, 10739, -11165, 11772, -11270,
  10914, -10444, 10191, -9644, 7964, -12307, 12258, -11818, 12058, -11872,
  11797, -12762, 14112, -11857, 12676, -6285, 7152, -5857, 6509, -5775, 7387,
  -6175, 7052, -9507, 9988, -10361, 11501, -10889, 11438, -12339, 12481, -10860,
  11686, -10757, 11920, -12166, 10551, -10049, 9491, -10235, 10196, -10703,
  10438, -11669, 10421, -6277, 6268, -10439, 9472, -10500, 12633, -11335, 12328,
  -10908, 11358, -10022, 11225, -11180, 11443, -6046, 5857, -6171, 5821, -6464,
  6548, -6085, 6002, -9623, 9835, -10190, 11104, -9520, 10891, -12534, 11788,
  -12548, 12940, -10970, 11636, -9550, 11004, -9978, 10861, -9750, 10214, -9975,
  9569, -11143, 10746, -6137, 7576, -10755, 12041, -10944, 12045, -10951, 11704,
  -10232, 10354, -10858, 10816, -6659, 6793, -5554, 6298, -7264, 6737, -7334,
  7858, -10284, 12728, -12045, 11133, -10575, 10895, -10664, 10945, -10720,
  11808, -11358, 10725, -10368, 10618, -10173, 9574, -9838, 11525, -10794,
  10348, -11795, 10629, -6211, 6717, -8101, 8811, -10358, 11373, -11609, 11506,
  -11343, 11436, -10171, 12197, -10962, 11370, -5600, 5937, -5447, 6153, -5721,
  6262, -5462, 5986, -9325, 10345, -7552, 8253, -7494, 8399, -8263, 9183, -7600,
  7923, -8748, 8868, -8842, 8440, -8551, 8703, -8582, 8567, -7713, 7715, -7995,
  8187, -3388, 3929, -8037, 8968, -8268, 9833, -8237, 9860, -8615, 9751, -9408,
  8784, -7684, 5606, -4509, 3322, -4156, 2907, -3954, 2751, -7335, 6807, -7475,
  8146, -8270, 7757, -8505, 7885, -7964, 7649, -8197, 8020, -8156, 7734, -7956,
  8360, -7907, 7735, -8224, 7453, -8837, 8084, -3496, 3266, -7942, 8587, -8364,
  8664, -8709, 9009, -8283, 9152, -8857, 8893, -9012, 8554, -3303, 3073, -3286,
  2553, -2967, 2405, -2436, 1935, -7232, 6933, -6786, 6897, -7077, 7048, -7559,
  7047, -7725, 7690, -7767, 7867, -7570, 7435, -8491, 8836, -8189, 8318, -7177,
  8527, -7648, 8159, -3246, 3012, -8309, 8289, -8481, 8575, -8214, 8095, -9017,
  8919, -9137, 9425, -9545, 6979, -3502, 3514, -3367, 3692, -3627, 3784, -8121,
  8326, -8756, 7811, -7680, 7753, -8243, 7884, -8549, 8010, -8653, 8132, -8410,
  7680, -8388, 7437, -8334, 7488, -8438, 7809, -8506, 7987, -4535, 3837, -6504,
  6840, -8619, 8161, -9126, 8938, -8972, 9479, -8646, 9542, -9337, 9399, -3291,
  3938, -3196, 3057, -2654, 2438, -1891, 1895, -8683, 8976, -10539, 10737,
  -9681, 10429, -11584, 10746, -11398, 11310, -10456, 11013, -10474, 11674,
  -10542, 10891, -9429, 9909, -10722, 10627, -10562, 10160, -6431, 6101, -8625,
  9080, -6976, 9198, -8112, 9157, -9090, 10952, -8936, 10578, -8574, 8236,
  -3986, 4509, -3356, 4092, -3156, 3692, -5565, 7368, -9542, 9961, -9754, 10926,
  -9852, 10025, -8989, 10363, -11396, 10865, -12907, 11854, -11482, 11934,
  -10314, 10101, -11196, 10804, -11367, 11112, -8784, 6992, -7024, 8254, -11058,
  12430, -12359, 12904, -10552, 12735, -10066, 10705, -10080, 10675, -6909,
  7862, -5789, 6848, -5793, 5417, -6830, 6062, -10549, 10308, -9045, 10799,
  -10624, 8703, -9456, 9250, -10815, 10661, -11495, 12290, -12688, 10818,
  -12924, 11674, -11517, 11315, -10854, 10247, -12292, 11311, -6872, 7944,
  -10543, 8852, -8277, 9161, -9231, 9043, -9017, 9288, -8882, 9957, -8416, 8674,
  -3899, 4471, -3472, 3895, -3633, 3852, -6230, 6810, -8947, 8664, -10731,
  11182, -11134, 10714, -10643, 10574, -12496, 11986, -12504, 11676, -11526,
  10474, -11059, 10142, -10945, 11269, -10268, 10738, -9133, 8511, -8055, 8545,
  -11337, 10772, -12959, 13012, -12961, 12183, -10470, 11741, -12044, 11589,
  -5341, 7243, -4675, 5364, -4733, 5790, -5777, 6241, -11445, 10876, -10715,
  10610, -10300, 10369, -11042, 10439, -12708, 12577, -11889, 11764, -11595,
  12513, -11234, 12055, -10584, 10612, -11289, 11590, -12002, 12451, -7654,
  7011, -8897, 10190, -8507, 10167, -8873, 10682, -8859, 10874, -10264, 9636,
  -9152, 8923, -4248, 4275, -3790, 4002, -4042, 3417, -4554, 3116, -7428, 8568,
  -8164, 8043, -8321, 7739, -8584, 8130, -8086, 8209, -8387, 7936, -7796, 8152,
  -7872, 8424, -8004, 7928, -9050, 8237, -7101, 6929, -3570, 3159, -8699, 8838,
  -8902, 9180, -8735, 9200, -8311, 9259, -9087, 8557, -4570, 3718, -3393, 2606,
  -3300, 2617, -2455, 2112, -8605, 8771, -9276, 10229, -10112, 10211, -10391,
  10487, -10291, 10692, -9984, 10414, -9567, 10070, -9866, 10517, -9914, 11559,
  -10323, 11101, -10631, 12663, -6584, 5957, -7950, 8859, -8705, 9630, -8568,
  8930, -9448, 9712, -9442, 9763, -9594, 9564, -4297, 4069, -3533, 3559, -3979,
  4235, -3479, 3298, -11327, 10114, -10720, 9646, -8955, 10998, -10256, 9281,
  -12039, 11132, -12429, 12232, -9783, 11707, -11172, 10655, -11961, 11019,
  -9444, 11768, -8448, 10297, -6632, 5525, -11792, 12891, -11163, 13714, -12299,
  13535, -12206, 13085, -12095, 13967, -5969, 8778, -5334, 6479, -5522, 5194,
  -5923, 6026, -11239, 10189, -10115, 10759, -11121, 10152, -10190, 10485,
  -10591, 10691, -11978, 10431, -12007, 14311, -11299, 13044, -12386, 12091,
  -11209, 11253, -11581, 11842, -7180, 7043, -8768, 8757, -8718, 8608, -9209,
  10883, -9716, 10983, -9608, 10873, -9061, 9671, -4211, 3730, -4517, 3875,
  -4419, 3394,
]
const peak1 = [
  -564, 15702, -251, 15642, -72, 15915, -389, 9840, -698, 7830, -1756, 5755,
]

const Wrap = styled.div`
  button {
    border: 1px solid #333;
  }
`
// background-color: #FFD500;
const Wave = styled.div`
  canvas {
    display: block;
    width: 100%;
    height: 128px;
  }
`

export function AudioWave() {
  const ref = useRef()

  const dpr = window.devicePixelRatio
  function wave() {
    const canvas = ref.current
    // console.log(peaks.length)
    const peaksData = samplePeaksData(peaks, canvas.width / dpr)
    // console.log(peaksData.length)
    // console.log(peaksData)
    const bits = 16
    let singleBarPixel = ~~(canvas.width / dpr / (peaksData.length / 2))
    singleBarPixel = singleBarPixel < 1 ? 1 : singleBarPixel
    // const barWidth = 1
    const barGap = 0
    const color = '#005BBB'
    const offset = 0

    const scale = dpr
    // const len = canvas.width / scale
    const cc = canvas.getContext('2d')
    const h2 = canvas.height / scale / 2
    const maxValue = 2 ** (bits - 1)
    // const width = barWidth
    const gap = barGap
    // const barStart = width + gap

    cc.clearRect(0, 0, canvas.width, canvas.height)

    cc.save()
    cc.fillStyle = color
    cc.scale(scale, scale)
    // console.log(singleBarPixel)
    for (let idx = 0, len = peaksData.length / 2; idx < len; idx++) {
      const minPeak = peaksData[(idx + offset) * 2] / maxValue
      const maxPeak = peaksData[(idx + offset) * 2 + 1] / maxValue
      drawFrame(
        cc,
        h2,
        idx * singleBarPixel,
        minPeak,
        maxPeak,
        singleBarPixel,
        gap
      )
    }

    cc.restore()
  }

  function drawFrame(cc, h2, x, minPeak, maxPeak, width, gap) {
    const min = Math.abs(minPeak * h2)
    const max = Math.abs(maxPeak * h2)
    // console.log(x, 0, width, h2 - max)
    // console.log(x, h2 + min, width, h2 - min)

    // draw max
    cc.fillRect(x, 0, width, h2 - max)
    // draw min
    cc.fillRect(x, h2 + min, width, h2 - min)
    // draw gap
    if (gap !== 0) {
      cc.fillRect(x + width, 0, gap, h2 * 2)
    }
  }

  useEffect(() => {
    const canvas = ref.current
    const obj = canvas.getBoundingClientRect()
    const { width, height } = obj
    canvas.width = width * dpr
    canvas.height = height * dpr
  }, [])

  return (
    <Wrap>
      <Wave>
        <canvas ref={ref} />
      </Wave>
      <button onClick={wave}>run</button>
    </Wrap>
  )
}
